{"version":3,"file":"file-upload.component.js","sourceRoot":"","sources":["file-upload.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAAkC,eAAe,CAAC,CAAA;AAClD,6BAA4B,cAAc,CAAC,CAAA;AAC3C,wCAAkC,0CAA0C,CAAC,CAAA;AAC7E,6BAA4B,iBAAiB,CAAC,CAAA;AAS9C;IAUE,6BACS,EAAc,EACd,IAAiB;QADjB,OAAE,GAAF,EAAE,CAAY;QACd,SAAI,GAAJ,IAAI,CAAa;QAV1B,YAAO,GAAW;YAChB,GAAG,EAAE,mEAAmE;YACxE,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW;YAChC,eAAe,EAAE,IAAI;SACtB,CAAC;QACF,mBAAc,GAAW,CAAC,CAAC;QAC3B,uBAAkB,GAAU,EAAE,CAAC;QAM7B,IAAI,CAAC,IAAI,GAAG,IAAI,aAAM,CAAC,EAAE,oBAAoB,EAAE,KAAK,EAAE,CAAC,CAAC;IAC1D,CAAC;IAED,8CAAgB,GAAhB,UAAiB,IAAI;QAArB,iBAkBC;QAjBC,IAAI,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAA,CAAC,IAAI,OAAA,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,EAAhB,CAAgB,CAAC,CAAC;QACrE,EAAE,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACjB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrC,CAAC;QACD,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;gBACZ,KAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;YACxC,CAAC,CAAC,CAAC;QACL,CAAC;QAED,IAAI,KAAK,GAAG,CAAC,EAAE,QAAQ,GAAG,CAAC,CAAC;QAC5B,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,UAAA,IAAI;YAClC,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;YAC7B,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC,CAAC;IAC7D,CAAC;IA1CH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,iBAAiB;YAC3B,WAAW,EAAE,4BAA4B;YACzC,SAAS,EAAE,CAAC,2BAA2B,CAAC;YACxC,UAAU,EAAE,CAAC,2CAAiB,CAAC;SAChC,CAAC;;2BAAA;IAsCF,0BAAC;AAAD,CAAC,AArCD,IAqCC;AArCY,2BAAmB,sBAqC/B,CAAA","sourcesContent":["import { Component, NgZone } from '@angular/core';\nimport { AngularFire } from 'angularfire2';\nimport { UPLOAD_DIRECTIVES } from '../file-uploader/file-uploader.component';\nimport { UserService } from '../user.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'file-upload-box',\n  templateUrl: 'file-upload.component.html',\n  styleUrls: ['file-upload.component.css'],\n  directives: [UPLOAD_DIRECTIVES]\n})\nexport class FileUploadComponent {\n  zone: NgZone;\n  options: Object = {\n    url: 'https://www.googleapis.com/upload/drive/v3/files?uploadType=media',\n    authToken: this.user.googleToken,\n    withCredentials: true\n  };\n  uploadProgress: number = 0;\n  fileUploadResponse: any[] = [];\n\n  constructor(\n    public af:AngularFire,\n    public user: UserService\n  ) {\n    this.zone = new NgZone({ enableLongStackTrace: false });\n  }\n\n  handleDropUpload(data):void {\n    let index = this.fileUploadResponse.findIndex(x => x.id === data.id);\n    if (index === -1) {\n      this.fileUploadResponse.push(data);\n    }\n    else {\n      this.zone.run(() => {\n        this.fileUploadResponse[index] = data;\n      });\n    }\n\n    let total = 0, uploaded = 0;\n    this.fileUploadResponse.forEach(resp => {\n      total += resp.progress.total;\n      uploaded += resp.progress.loaded;\n    });\n\n    this.uploadProgress = Math.floor(uploaded / (total / 100));\n  }\n\n}\n"]}